{"version":3,"sources":["webpack:///./main.js","webpack:///./source/index.js","webpack:///./source/index.scss"],"names":["App","props","state","tags","id","title","x","y","index","maxLength","onReplace","bind","onDelete","element","array","setState","render","document","getElementById","Tagging","chosenIndex","deleteTag","hideAllDeletes","forEach","call","ReactDOM","findDOMNode","refs","querySelectorAll","classList","add","tag","filter","ind","backgroundImage","image","width","height","map","canMove","startMoving","addEventListener","processMoving","ref","wrapper","getBoundingClientRect","boundingClientRect","style","cursor","left","event","pageX","parseFloat","top","pageY","deleteElement","querySelector","remove","stopMoving","removeEventListener","zIndex","stopPropagation","length","slice","defaultProps","Function","prototype","propTypes","PropTypes","string","arrayOf","shape","number","func"],"mappings":"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","file":"main.js","sourcesContent":["'use strict';\n\nimport React, { PureComponent } from 'react';\nimport { render } from 'react-dom';\n\nimport Tagging from './source/index';\n\nexport default class App extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      tags: [\n        {\n          id: 'id_1',\n          title: 'Lorem Ipsum',\n          x: 200,\n          y: 200,\n          index: 0\n        },\n        {\n          id: 'id_2',\n          title: 'Lorem',\n          x: 200,\n          y: 300,\n          index: 1\n        },\n        {\n          id: 'id_3',\n          title: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit',\n          x: 100,\n          y: 100,\n          index: 1\n        }\n      ]\n    };\n    this.maxLength = 20;\n\n    this.onReplace = this.onReplace.bind(this);\n    this.onDelete = this.onDelete.bind(this);\n  }\n\n  onReplace(element, index, array) {\n    if (array) {\n      this.setState({tags: array});\n    }\n  }\n\n  onDelete(element, index, array) {\n    if (array) {\n      this.setState({tags: array});\n    }\n  }\n\n  render() {\n    return (\n      <Tagging\n        image={'./image.jpg'}\n        width={'512px'}\n        height={'512px'}\n        tags={this.state.tags}\n        onReplace={this.onReplace}\n        onDelete={this.onDelete}\n        maxLength={this.maxLength}\n      />\n    );\n  }\n}\n\nrender(\n    <App/>,\n    document.getElementById('react-app')\n);\n\n\n\n// WEBPACK FOOTER //\n// ./main.js","'use strict';\n\nimport React, { PureComponent, PropTypes } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.scss';\n\nexport default class Tagging extends PureComponent {\n  static defaultProps = {\n    image: '',\n    width: '400px',\n    height: '400px',\n    tags: [],\n    onReplace: Function.prototype,\n    onDelete: Function.prototype,\n    maxLength: 16\n  };\n\n  static propTypes = {\n    image: PropTypes.string,\n    width: PropTypes.string,\n    height: PropTypes.string,\n    tags: PropTypes.arrayOf(PropTypes.shape({\n        id: PropTypes.string,\n        title: PropTypes.string,\n        x: PropTypes.number,\n        y: PropTypes.number,\n        index: PropTypes.number\n    })),\n    onReplace: PropTypes.func,\n    onDelete: PropTypes.func,\n    maxLength: PropTypes.number\n  };\n\n  constructor(props) {\n      super(props);\n\n      this.state = {\n        chosenIndex: null\n      };\n\n      this.deleteTag = this.deleteTag.bind(this);\n      this.hideAllDeletes = this.hideAllDeletes.bind(this);\n  }\n\n  hideAllDeletes() {\n    [].forEach.call(ReactDOM.findDOMNode(this.refs['tagging-wrapper']).querySelectorAll('.delete'), element => {\n      element.classList.add('hide');\n    });\n  }\n\n  deleteTag(tag, index) {\n    this.hideAllDeletes();\n    this.setState({chosenIndex: null});\n    this.props.onDelete(tag, index, this.props.tags.filter((tag, ind) => ind !== index));\n  }\n\n  render() {\n      return (\n        <div\n          className={'tagging-wrapper'}\n          style={{\n            backgroundImage: `url(${this.props.image})`,\n            width: this.props.width,\n            height: this.props.height,\n          }}\n          ref='tagging-wrapper'\n          onClick={() => {\n            this.hideAllDeletes();\n            this.setState({chosenIndex: null});\n          }}\n        >\n          {this.props.tags.map((tag, index) => {\n            // closure veriables\n            let canMove = false;\n            let startMoving = event => {\n              canMove = true;\n              document.addEventListener('mousemove', processMoving, false);\n              document.addEventListener('touchmove', processMoving, false);\n            };\n            let processMoving = event => {\n              if (canMove && this.state.chosenIndex === index) {\n                let ref = ReactDOM.findDOMNode(this.refs[index]);\n                if (ref) {\n                  let wrapper = ReactDOM.findDOMNode(this.refs['tagging-wrapper']).getBoundingClientRect(),\n                    boundingClientRect = ref.getBoundingClientRect();\n                  ref.style.cursor = '-webkit-grabbing';\n                  ref.style.cursor = 'grabbing';\n                  // handle borders\n                  if (wrapper.left + boundingClientRect.width / 2 > event.pageX) {\n                    tag.x = 0;\n                  } else if (wrapper.left + wrapper.width - boundingClientRect.width / 2 < event.pageX) {\n                    tag.x = wrapper.width - boundingClientRect.width;\n                  } else {\n                    tag.x = parseFloat(ref.style.left) + event.pageX - (boundingClientRect.left + boundingClientRect.width / 2);\n                  }\n                  if (wrapper.top + boundingClientRect.height / 2 > event.pageY) {\n                    tag.y = 0;\n                  } else if (wrapper.top + wrapper.height - boundingClientRect.height / 2 < event.pageY) {\n                    tag.y = wrapper.height - boundingClientRect.height;\n                  } else {\n                    tag.y = parseFloat(ref.style.top) + event.pageY - (boundingClientRect.top + boundingClientRect.height / 2);\n                  }\n\n                  // handle .delete position\n                  let deleteElement = ref.querySelector('.delete');\n                  if (wrapper.left + wrapper.width - boundingClientRect.width / 2 < event.pageX + deleteElement.getBoundingClientRect().width) {\n                    deleteElement.classList.add('pull-left');\n                  } else {\n                    deleteElement.classList.remove('pull-left');\n                  }\n\n                  // set values\n                  ref.style.left = tag.x + 'px';\n                  ref.style.top = tag.y + 'px';\n                }\n              }\n            };\n            let stopMoving = event => {\n              let ref = ReactDOM.findDOMNode(this.refs[index]);\n              ref.style.cursor = '';\n              this.props.onReplace(tag, index, this.props.tags.map((tag, ind) => {\n                if (ind === index) {\n                  tag.x = parseFloat(ref.style.left);\n                  tag.y = parseFloat(ref.style.top);\n                }\n                return tag;\n              }));\n              canMove = false;\n              document.removeEventListener('mousemove', processMoving);\n              document.removeEventListener('touchmove', processMoving);\n            };\n            return (\n              <div\n                className={`tagging-element ${this.state.chosenIndex === index ? 'grab-mode' : ''}`}\n                key={tag.id}\n                ref={index}\n                style={{\n                  zIndex: tag.index,\n                  left: tag.x,\n                  top: tag.y\n                }}\n                onClick={event => {\n                  event.stopPropagation();\n                  this.hideAllDeletes();\n                  this.setState({chosenIndex: index});\n                  ReactDOM.findDOMNode(this.refs[index]).querySelector('.delete').classList.remove('hide');\n                }}\n                onMouseDown={startMoving}\n                onTouchStart={startMoving}\n                onMouseUp={stopMoving}\n                onTouchEnd={stopMoving}\n              >\n                <span\n                  className={'title'}\n                >\n                  {tag.title.length + 3 > this.props.maxLength ? tag.title.slice(0, this.props.maxLength - 3) + '...' : tag.title}\n                </span>\n                <span\n                  className={'delete hide'}\n                  onClick={event => {\n                    event.stopPropagation();\n                    this.deleteTag(tag, index);\n                  }}\n                >X</span>\n              </div>\n            );\n          })}\n        </div>\n      );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./source/index.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./source/index.scss\n// module id = 82\n// module chunks = 0"],"sourceRoot":""}